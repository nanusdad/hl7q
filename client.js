var net = require('net');
var client = new net.Socket();

//var ddpdata='{ "listId": "kRDgT9ev4xegEAM3T", "firstname": "Patient", "middlename": "", "lastname": "One", "patientvisit": "PV1", "unit": "MED/SURG", "floor": 1, "bed": 112, "readings": [{ "name": " SpO₂", "units_short": "%", "units_long": "Percent", "value": "99" }], "createdAt": 1531479951343, "archiveChecked": false, "assignee" : "" }';

//var ddpdata='♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717051637.8010-0700||ORU^R40^ORU_R40|2ca4f8b3-0866-4060-b57a-63fb554c\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|619a0d17-7943-4134-8136-28aed3999c28^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717051637.8011-0700||||||||||||||||||||||^6bb8a383-8a42-4c74-ad2e-98d0aab5cb9b&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180717051637.790-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|98|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180717\r∟BX|7|ST|68483^MDC_ATTR_ALARM_INACTIVATION_STATE^MDC|1.1.0.1.5|enabled||||||R';

//var ddpdata='♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.1914-0700||ORU^R40^ORU_R40|2ec7828e-e093-4b0b-9fa5-18154363\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|6b59a9c1-6874-4201-a719-443d9b50aa49^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717052709.1915-0700||||||||||||||||||||||^96fda767-497b-4f24-836e-eef8257f31e9&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180717052553.541-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|95|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180717\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.1946-0700||ORU^R40^ORU_R40|8cc5a6f3-96b1-4bc1-af5d-b8b873ce\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|f9676ef0-abb6-44e2-9f5e-daea8c265132^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717052709.1947-0700||||||||||||||||||||||^aad579f6-b815-47ec-8fd8-736f5e7e9cae&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180717051757.754-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|95|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180717\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.1974-0700||ORU^R40^ORU_R40|18e92017-a12c-4bae-8338-96d4f577\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|ca2311e5-de39-4302-9874-f8f409b74302^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717052709.1976-0700||||||||||||||||||||||^730b4251-6773-4bb4-81b6-61320d093e9c&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196960^MDC_EVT_MSMT_DISCONN^MDC|1.1.0.0.1|SENSOR OFF|||ST|||R|||20180717051647.787-0700||||\rOBX|4|CWE|68480^MDC_ATTR_ALERT_SOURCE^MDC|1.1.0.0.2|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC||||\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.2003-0700||ORU^R40^ORU_R40|a90ac109-7d2f-4633-b1e8-fe3fd147\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|ac73b67c-a827-440c-adb5-f8e20a016926^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717052709.2004-0700||||||||||||||||||||||^482c8f1a-a67b-4e00-963e-1867f99c6686&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180717051655.782-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|95|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180717\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.2033-0700||ORU^R40^ORU_R40|405eb3d4-f3c3-4593-8485-592be26c\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|603e2d83-17ca-41b1-95fd-b9808bb76bc8^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180717052709.2034-0700||||||||||||||||||||||^65317aad-e608-4e5d-bee0-1e2c8acfb099&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180717050727.587-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|95|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180717\r∟BX|7|ST|68483^MDC_ATTR_ALARM_INACTIVATION_STATE^MDC|1.1.0.1.5|enabled||||||R\rundefined:1\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180717052709.1914-0700||ORU^R40^ORU_R40|2ec7828e-e093-4b0b-9fa5-18154363dc8b|P|2.6|||AL|NE|||||IHE_PCD_ACM_001^IHE PCD^1.3.6.1.4.1.19376.1.6.4.4.1^ISO';

var ddpdata='♂MSH|^~\&|PSN|PSN|EMR|EMR|20180730012132.3398-0700||ORU^R40^ORU_R40|a648a014-e317-422e-8c9c-d5fade54\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|7109cc18-408e-4f95-88f5-e7467040743a^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180730012132.3400-0700||||||||||||||||||||||^5522975a-cdce-4af8-8cf3-9bc7e4f0dda4&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|SPO2 LOW|||L~SP|||R|||20180730002711.335-0700|||\rOBX|4|NM|150456^MDC_PULS_OXIM_SAT_O2^MDC|1.1.0.1.2|96|262688^MDC_DIM_PERCENT^MDC|>98||||R|||20180730\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180730012132.3412-0700||ORU^R40^ORU_R40|39118aca-6e02-4d5c-a511-29cfab47\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|7060d2ce-bbbd-4d58-81a0-78eea2a9fee4^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180730012132.3413-0700||||||||||||||||||||||^7b1efbdc-af62-46cc-b9e1-d5ca6254ac2d&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196652^MDC_EVT_HI_VAL_GT_LIM^MDC|1.1.0.1.1|PR HIGH|||H~SP|||R|||20180730012132.327-0700||||\rOBX|4|NM|149530^MDC_PULS_OXIM_PULS_RATE^MDC|1.1.0.1.2|50|264864^MDC_DIM_BEAT_PER_MIN^MDC|45-50||||R|\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180730012132.3428-0700||ORU^R40^ORU_R40|43788338-9f49-44d1-9504-370963df\rOBR|1|c1b7c69d-d8ec-402b-951e-5045f036d035^^dc4a3effff61e11f^EUI-64|94f1317f-44c5-47e0-99f2-283ff1122659^^dc4a3effff61e11f^EUI-64|196616^MDC_EVT_ALARM^MDC|||20180730012132.3429-0700||||||||||||||||||||||^caa118a4-b53f-4b0c-bacd-e3e3ba9416d8&&dc4a3effff61e11f&EUI-64|||||||||||||||252465000^Pulse oxim\rOBX|1|ST|69965^MDC_DEV_MON_PHYSIO_MULTI_PARAM_MDS^MDC|1.0.0.0|||||||X|||||||2000009264^Eagle^masimo.\rOBX|3|ST|196674^MDC_EVT_LO_VAL_LT_LIM^MDC|1.1.0.1.1|PI LOW|||L~SP|||R|||20180730012033.333-0700||||2\rOBX|4|NM|192519^MDC_PULS_OXIM_PERFUSION_INDEX^99MASIMO|1.1.0.1.2|1.00|262688^MDC_DIM_PERCENT^MDC|>2.\r∟BX|7|ST|68483^MDC_ATTR_ALARM_INACTIVATION_STATE^MDC|1.1.0.1.5|alarm-off||||||R\r♂MSH|^~\&|PSN|PSN|EMR|EMR|20180730003810.0531-0700||NMD^N02^NMD_N02|52a4e433-e01a-4725-9d41-6cda9f25\r∟CK|20180730003810.0531-0700CD_001^IHE PCD^1.3.6.1.4.1.19376.1.6.1.1.1^ISO';

client.connect(3300, 'localhost', function() {
	console.log('Connected');
	/* client.write('Hello, server! Love, Client.');
	 client.write(hl7_alert); */
	client.write(ddpdata);
});
var i = 0;
client.on('data', function(data) {
	console.log('Received: ' + data);
	i++;
	if(i==2)
		client.destroy(); 
});
client.on('close', function() {
	console.log('Connection closed');
});
