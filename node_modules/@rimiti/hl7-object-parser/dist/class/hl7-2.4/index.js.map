{"version":3,"sources":["class/hl7-2.4/index.js"],"names":["hl7","message","config","hl7Parser","Parser","parse","_message","_config","obj","segment","mapping","s","toUpperCase","header","getSegment","values","value","field","Object","index1","component","index2","getField","includes","split","array","v","push","output","console","log","Date","now","_generateObject","getComponent","property","paths","i","tmp","length","assign"],"mappings":";;;;;;;;AAAA;;;;;;;;IAEqBA,G;AAEpB,cAAYC,OAAZ,EAAqBC,MAArB,EAA6B;AAAA;;AAC5B,MAAMC,YAAY,IAAI,mBAAUC,MAAd,EAAlB;AACAH,YAAUE,UAAUE,KAAV,CAAgBJ,OAAhB,CAAV;AACA,OAAKK,QAAL,GAAgBL,OAAhB;AACA,OAAKM,OAAL,GAAeL,MAAf;AACA;;AAED;;;;;;;;4BAIU;AACT,OAAIM,MAAM,EAAV;AACA,QAAK,IAAIC,OAAT,IAAoB,KAAKF,OAAL,CAAaG,OAAjC,EAA0C;AACzC,QAAIC,IAAKF,QAAQG,WAAR,OAA0B,KAA3B,GAAoC,KAAKN,QAAL,CAAcO,MAAlD,GAA2D,KAAKP,QAAL,CAAcQ,UAAd,CAAyBL,QAAQG,WAAR,EAAzB,CAAnE;AADyC;AAAA;AAAA;;AAAA;AAEzC,0BAAkB,KAAKL,OAAL,CAAaG,OAAb,CAAqBD,OAArB,EAA8BM,MAAhD,8HAAwD;AAAA,UAA/CC,KAA+C;;AACvD,UAAIA,MAAMC,KAAN,IAAeN,aAAaO,MAAhC,EAAwC;AACvC,WAAIC,SAASH,MAAMI,SAAN,CAAgB,CAAhB,CAAb;AACA,WAAIC,SAASL,MAAMI,SAAN,CAAgB,CAAhB,CAAb;;AAEA,WAAIT,EAAEW,QAAF,CAAWH,MAAX,EAAmBI,QAAnB,CAA4B,GAA5B,CAAJ,EAAsC;AACrC,YAAIC,QAAQb,EAAEW,QAAF,CAAWH,MAAX,EAAmBK,KAAnB,CAAyB,GAAzB,CAAZ;AACA,YAAIC,QAAQ,EAAZ;AAFqC;AAAA;AAAA;;AAAA;AAGrC,+BAAcD,KAAd,mIAAqB;AAAA,cAAZE,EAAY;;AACpBD,gBAAME,IAAN,CAAWD,GAAEF,KAAF,CAAQ,GAAR,CAAX;AACA;AALoC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOrC,YAAII,SAAS,EAAb;AACA,aAAK,IAAIF,CAAT,IAAcD,KAAd,EAAqB;AACnBA,eAAMC,CAAN,EAASV,MAAMI,SAAN,CAAgB,CAAhB,IAAqB,CAA9B,CAAD,GAAqCQ,OAAOD,IAAP,CAAYF,MAAMC,CAAN,EAASV,MAAMI,SAAN,CAAgB,CAAhB,IAAqB,CAA9B,CAAZ,CAArC,GAAoFQ,OAAOD,IAAP,CAAY,EAAZ,CAApF;AACA;AACDE,gBAAQC,GAAR,CAAYd,MAAMC,KAAlB;AACA,YAAIT,IAAIQ,MAAMC,KAAV,CAAJ,EAAsB;AACrBD,eAAMC,KAAN,GAAcD,MAAMC,KAAN,GAAcc,KAAKC,GAAL,EAA5B;AACA,cAAKC,eAAL,CAAqBzB,GAArB,EAA0BQ,MAAMC,KAAhC,EAAuCW,MAAvC;AACA,SAHD,MAGO;AACN,cAAKK,eAAL,CAAqBzB,GAArB,EAA0BQ,MAAMC,KAAhC,EAAuCW,MAAvC;AACA;AACD,QAlBD,MAkBO;AACN,YAAIpB,IAAIQ,MAAMC,KAAV,CAAJ,EAAsB;AACrBD,eAAMC,KAAN,GAAcD,MAAMC,KAAN,GAAcc,KAAKC,GAAL,EAA5B;AACA,cAAKC,eAAL,CAAqBzB,GAArB,EAA0BQ,MAAMC,KAAhC,EAAuCN,EAAEuB,YAAF,CAAef,MAAf,EAAuBE,MAAvB,CAAvC;AACA,SAHD,MAGO;AACN,cAAKY,eAAL,CAAqBzB,GAArB,EAA0BQ,MAAMC,KAAhC,EAAuCN,EAAEuB,YAAF,CAAef,MAAf,EAAuBE,MAAvB,CAAvC;AAEA;AAED;AACD;AACD;AApCwC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqCzC;AACD,UAAOb,GAAP;AACA;;AAED;;;;;;;;;;kCAOgBA,G,EAAK2B,Q,EAAUnB,K,EAAO;AACrC,OAAIoB,QAAQD,SAASX,KAAT,CAAe,GAAf,CAAZ;AACA,OAAIa,IAAI,CAAR;AACA,OAAIC,MAAM9B,GAAV;AACA,UAAO6B,IAAID,MAAMG,MAAN,GAAe,CAA1B,EAA6BF,GAA7B,EAAkC;AACjCC,UAAOA,IAAIF,MAAMC,CAAN,CAAJ,CAAD,GAAkBnB,OAAOsB,MAAP,CAAcF,IAAIF,MAAMC,CAAN,CAAJ,CAAd,EAA6BC,IAAIF,MAAMC,CAAN,CAAJ,CAA7B,CAAlB,GAAgEC,IAAIF,MAAMC,CAAN,CAAJ,IAAgB,EAAtF;AACA;AACDC,OAAIF,MAAMC,CAAN,CAAJ,IAAgBrB,KAAhB;AACA;;;;;;kBAvEmBhB,G","file":"index.js","sourcesContent":["import simpleHL7 from 'simple-hl7'\r\n\r\nexport default class hl7 {\r\n\r\n\tconstructor(message, config) {\r\n\t\tconst hl7Parser = new simpleHL7.Parser()\r\n\t\tmessage = hl7Parser.parse(message)\r\n\t\tthis._message = message\r\n\t\tthis._config = config\r\n\t}\r\n\r\n\t/**\r\n\t * @description Convert from config mapping file hl7 to object\r\n\t * @return {{}}\r\n\t */\r\n\tprocess() {\r\n\t\tlet obj = {}\r\n\t\tfor (let segment in this._config.mapping) {\r\n\t\t\tlet s = (segment.toUpperCase() === 'MSH') ? this._message.header : this._message.getSegment(segment.toUpperCase())\r\n\t\t\tfor (let value of this._config.mapping[segment].values) {\r\n\t\t\t\tif (value.field && s instanceof Object) {\r\n\t\t\t\t\tlet index1 = value.component[0]\r\n\t\t\t\t\tlet index2 = value.component[1]\r\n\r\n\t\t\t\t\tif (s.getField(index1).includes('~')) {\r\n\t\t\t\t\t\tlet split = s.getField(index1).split('~')\r\n\t\t\t\t\t\tlet array = []\r\n\t\t\t\t\t\tfor (let v of split) {\r\n\t\t\t\t\t\t\tarray.push(v.split('^'))\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet output = []\r\n\t\t\t\t\t\tfor (let v in array) {\r\n\t\t\t\t\t\t\t(array[v][value.component[1] - 1]) ? output.push(array[v][value.component[1] - 1]): output.push('')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.log(value.field);\r\n\t\t\t\t\t\tif (obj[value.field]) {\r\n\t\t\t\t\t\t\tvalue.field = value.field + Date.now();\r\n\t\t\t\t\t\t\tthis._generateObject(obj, value.field, output)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._generateObject(obj, value.field, output)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (obj[value.field]) {\r\n\t\t\t\t\t\t\tvalue.field = value.field + Date.now();\r\n\t\t\t\t\t\t\tthis._generateObject(obj, value.field, s.getComponent(index1, index2))\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._generateObject(obj, value.field, s.getComponent(index1, index2))\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn obj\r\n\t}\r\n\r\n\t/**\r\n\t * @description Add attribute(s) into existing object\r\n\t * @param obj\r\n\t * @param property\r\n\t * @param value\r\n\t * @private\r\n\t */\r\n\t_generateObject(obj, property, value) {\r\n\t\tlet paths = property.split('.')\r\n\t\tlet i = 0\r\n\t\tlet tmp = obj\r\n\t\tfor (; i < paths.length - 1; i++) {\r\n\t\t\ttmp = (tmp[paths[i]]) ? Object.assign(tmp[paths[i]], tmp[paths[i]]) : tmp[paths[i]] = {}\r\n\t\t}\r\n\t\ttmp[paths[i]] = value\r\n\t}\r\n\r\n}\r\n"],"sourceRoot":"C:\\Users\\lenovo\\AppData\\Roaming\\npm-cache\\_cacache\\tmp\\git-clone-d3a2bac1\\src"}